\NeedsTeXFormat{LaTeX2e}[1999/12/01]
\ProvidesPackage{libbib}[2015/07/16 v0.1 LaTeX/BibTeX library]
\RequirePackage{amsmath}
\RequirePackage{xparse}
\RequirePackage{acronym}
\RequirePackage{textcomp}
\RequirePackage{ifthen}
\DeclareOption{stdmaths}{%
  % General maths
  %\ProvideDocumentCommand{\ord}{m}{\ensuremath{|#1|}}
  \DeclareMathOperator{\Z}{\mathbb{Z}}
  \DeclareMathOperator{\N}{\mathbb{N}}
  \ProvideDocumentCommand{\textand}{}{\ensuremath{\qquad\text{and}\qquad}}
  \ProvideDocumentCommand{\Prob}{o o m}{\ensuremath{%
    \Pr%
    \IfValueT{#1}{\ifthenelse{\equal{#1}{}}{}{_{#1}}}%
    \IfValueT{#2}{^{#2}}%
    \mathopen{}\left[%
      \ifthenelse{\equal{#3}{}}{\cdot}{#3}%
    \right]\mathclose{}%
  }}
}
\DeclareOption{algebra}{%
  % Galois fields (finite fields)
  \DeclareMathOperator{\GF}{\mathrm{GF}}
  \DeclareMathOperator{\F}{\mathbb{F}}
  \DeclareMathOperator{\ord}{ord}
  \ProvideDocumentCommand{\card}{m}{\ensuremath{|#1|}}
}
\DeclareOption{crypto}{%
  % General algorithmic parts
  %\DeclareMathOperator{\K}{\mathcal{K}}
  \DeclareMathOperator{\M}{\mathcal{M}}
  \DeclareMathOperator{\C}{\mathcal{C}}
  \ProvideDocumentCommand{\Scheme}{s m}{%
    \IfBooleanTF{#1}{%
      \ensuremath{\overline{\mathcal{#2}}}%
    }{%
      \ensuremath{\mathcal{#2}}%
    }
  }
  \ProvideDocumentCommand{\indcpa}{}{\ensuremath{\text{IND-CPA}}}
  \ProvideDocumentCommand{\indcca}{}{\ensuremath{\text{IND-CCA}}}
  \ProvideDocumentCommand{\indsfcca}{}{\ensuremath{\text{IND-SFCCA}}}
  \ProvideDocumentCommand{\intptxt}{}{\ensuremath{\text{INT-PTXT}}}
  \ProvideDocumentCommand{\intctxt}{}{\ensuremath{\text{INT-CTXT}}}
  \ProvideDocumentCommand{\intsfctxt}{}{\ensuremath{\text{INT-SFCTXT}}}
  \ProvideDocumentCommand{\nmcpa}{}{\ensuremath{\text{NM-CPA}}}
  \ProvideDocumentCommand{\nmcca}{}{\ensuremath{\text{NM-CCA}}}
  \ProvideDocumentCommand{\sufcma}{}{\ensuremath{\text{SUF-CMA}}}
  \ProvideDocumentCommand{\denss}{}{\ensuremath{\text{DEN-SS}}}
  \ProvideDocumentCommand{\rgets}{}{\overset{\text{\textcent}}{\gets}}
  \DeclareMathOperator{\AdvOp}{\mathbf{Adv}}
  \ProvideDocumentCommand{\Adv}{m m o}{%
    \IfValueTF{#3}{%
      \ensuremath{\AdvOp^{#1}_{#2}\left( #3 \right)}%
    }{%
      \ensuremath{\AdvOp^{#1}_{#2}\left( \cdot \right)}%
    }%
  }
  \DeclareMathOperator{\ExpOp}{\mathbf{Exp}}
  \ProvideDocumentCommand{\Exp}{m m o}{%
    \IfValueTF{#3}{%
      \ensuremath{\ExpOp^{#1}_{#2}\left( #3 \right)}%
    }{%
      \ensuremath{\ExpOp^{#1}_{#2}\left( \cdot \right)}%
    }%
  }
  % Cryptographic functions
  % XXX Make all crypto functions commands
  \DeclareMathOperator{\GenOp}{\mathsf{Gen}}
  \ProvideDocumentCommand{\Gen}{s o m}{\ensuremath{%
    \IfBooleanTF{#1}{%
      \overline{\GenOp}%
      \IfValueT{#2}{^{#2}}%
      \ifthenelse{\equal{#3}{}}{}{\mathopen{}\left(#3\right)\mathclose{}}%
    }{%
      \GenOp%
      \IfValueT{#2}{^{#2}}%
      \ifthenelse{\equal{#3}{}}{}{\mathopen{}\left(#3\right)\mathclose{}}%
    }%
  }}
  \DeclareMathOperator{\KeygenOp}{\mathsf{Keygen}}
  \ProvideDocumentCommand{\Keygen}{s o m}{\ensuremath{%
    \IfBooleanTF{#1}{%
      \overline{\KeygenOp}%
      \IfValueT{#2}{^{#2}}%
      \ifthenelse{\equal{#3}{}}{}{\mathopen{}\left(#3\right)\mathclose{}}%
    }{%
      \KeygenOp%
      \IfValueT{#2}{^{#2}}%
      \ifthenelse{\equal{#3}{}}{}{\mathopen{}\left(#3\right)\mathclose{}}%
    }%
  }}
  \DeclareMathOperator{\SignOp}{\mathsf{Sign}}
  \ProvideDocumentCommand{\Sign}{s o o m}{\ensuremath{%
    \IfBooleanTF{#1}{%
      \overline{\SignOp}%
      \IfValueT{#2}{_{#2}}%
      \IfValueT{#3}{^{#3}}%
      \ifthenelse{\equal{#4}{}}{}{\mathopen{}\left(#4\right)\mathclose{}}%
    }{%
      \SignOp%
      \IfValueT{#2}{_{#2}}%
      \IfValueT{#3}{^{#3}}%
      \ifthenelse{\equal{#4}{}}{}{\mathopen{}\left(#4\right)\mathclose{}}%
    }%
  }}
  %\DeclareMathOperator{\Hash}{\mathsf{Hash}}
  \DeclareMathOperator{\MACOp}{\mathsf{MAC}}
  \ProvideDocumentCommand{\MAC}{s o o m}{\ensuremath{%
    \IfBooleanTF{#1}{%
      \overline{\MACOp}%
      \IfValueT{#2}{_{#2}}%
      \IfValueT{#3}{^{#3}}%
      \ifthenelse{\equal{#4}{}}{}{\mathopen{}\left(#4\right)\mathclose{}}%
    }{%
      \MACOp%
      \IfValueT{#2}{_{#2}}%
      \IfValueT{#3}{^{#3}}%
      \ifthenelse{\equal{#4}{}}{}{\mathopen{}\left(#4\right)\mathclose{}}%
    }%
  }}
  \DeclareMathOperator{\TagOp}{\mathsf{Tag}}
  \ProvideDocumentCommand{\Tag}{s o o m}{\ensuremath{%
    \IfBooleanTF{#1}{%
      \overline{\TagOp}%
      \IfValueT{#2}{_{#2}}%
      \IfValueT{#3}{^{#3}}%
      \ifthenelse{\equal{#4}{}}{}{\mathopen{}\left(#4\right)\mathclose{}}%
    }{%
      \TagOp%
      \IfValueT{#2}{_{#2}}%
      \IfValueT{#3}{^{#3}}%
      \ifthenelse{\equal{#4}{}}{}{\mathopen{}\left(#4\right)\mathclose{}}%
    }%
  }}
  \DeclareMathOperator{\VerifyOp}{\mathsf{Verify}}
  \ProvideDocumentCommand{\Verify}{s o o m}{\ensuremath{%
    \IfBooleanTF{#1}{%
      \overline{\VerifyOp}%
      \IfValueT{#2}{_{#2}}%
      \IfValueT{#3}{^{#3}}%
      \ifthenelse{\equal{#4}{}}{}{\mathopen{}\left(#4\right)\mathclose{}}%
    }{%
      \VerifyOp%
      \IfValueT{#2}{_{#2}}%
      \IfValueT{#3}{^{#3}}%
      \ifthenelse{\equal{#4}{}}{}{\mathopen{}\left(#4\right)\mathclose{}}%
    }%
  }}
  \DeclareMathOperator{\EncOp}{\mathsf{Enc}}
  \ProvideDocumentCommand{\Enc}{s o o m}{\ensuremath{%
    \IfBooleanTF{#1}{%
      \overline{\EncOp}%
      \IfValueT{#2}{_{#2}}%
      \IfValueT{#3}{^{#3}}%
      \ifthenelse{\equal{#4}{}}{}{\mathopen{}\left(#4\right)\mathclose{}}%
    }{%
      \EncOp%
      \IfValueT{#2}{_{#2}}%
      \IfValueT{#3}{^{#3}}%
      \ifthenelse{\equal{#4}{}}{}{\mathopen{}\left(#4\right)\mathclose{}}%
    }%
  }}
  \DeclareMathOperator{\DecOp}{\mathsf{Dec}}
  \ProvideDocumentCommand{\Dec}{s o o m}{\ensuremath{%
    \IfBooleanTF{#1}{%
      \overline{\DecOp}%
      \IfValueT{#2}{_{#2}}%
      \IfValueT{#3}{^{#3}}%
      \ifthenelse{\equal{#4}{}}{}{\mathopen{}\left(#4\right)\mathclose{}}%
    }{%
      \DecOp%
      \IfValueT{#2}{_{#2}}%
      \IfValueT{#3}{^{#3}}%
      \ifthenelse{\equal{#4}{}}{}{\mathopen{}\left(#4\right)\mathclose{}}%
    }%
  }}
  \DeclareMathOperator{\AuthEncOp}{\mathsf{AuthEnc}}
  \ProvideDocumentCommand{\AuthEnc}{s o o m}{\ensuremath{%
    \IfBooleanTF{#1}{%
      \overline{\AuthEncOp}%
      \IfValueT{#2}{_{#2}}%
      \IfValueT{#3}{^{#3}}%
      \ifthenelse{\equal{#4}{}}{}{\mathopen{}\left(#4\right)\mathclose{}}%
    }{%
      \AuthEncOp%
      \IfValueT{#2}{_{#2}}%
      \IfValueT{#3}{^{#3}}%
      \ifthenelse{\equal{#4}{}}{}{\mathopen{}\left(#4\right)\mathclose{}}%
    }%
  }}
  \DeclareMathOperator{\AuthDecOp}{\mathsf{AuthDec}}
  \ProvideDocumentCommand{\AuthDec}{s o o m}{\ensuremath{%
    \IfBooleanTF{#1}{%
      \overline{\AuthDecOp}%
      \IfValueT{#2}{_{#2}}%
      \IfValueT{#3}{^{#3}}%
      \ifthenelse{\equal{#4}{}}{}{\mathopen{}\left(#4\right)\mathclose{}}%
    }{%
      \AuthDecOp%
      \IfValueT{#2}{_{#2}}%
      \IfValueT{#3}{^{#3}}%
      \ifthenelse{\equal{#4}{}}{}{\mathopen{}\left(#4\right)\mathclose{}}%
    }%
  }}
  \DeclareMathOperator{\VerifDecOp}{\mathsf{AuthDec}}
  \ProvideDocumentCommand{\VerifDec}{s o o m}{\ensuremath{%
    \IfBooleanTF{#1}{%
      \overline{\VerifDecOp}%
      \IfValueT{#2}{_{#2}}%
      \IfValueT{#3}{^{#3}}%
      \ifthenelse{\equal{#4}{}}{}{\mathopen{}\left(#4\right)\mathclose{}}%
    }{%
      \VerifDecOp%
      \IfValueT{#2}{_{#2}}%
      \IfValueT{#3}{^{#3}}%
      \ifthenelse{\equal{#4}{}}{}{\mathopen{}\left(#4\right)\mathclose{}}%
    }%
  }}
  % Cryptographic parts
  \ProvideDocumentCommand{\Key}{s m}{\ensuremath{%
    \IfBooleanT{#1}{\hat}k%
    %\IfValueT{#2}{^{#2}}%
    \ifthenelse{\equal{#2}{}}{}{_{#2}}%
  }}
  \ProvideDocumentCommand{\PubKey}{s m}{\ensuremath{%
    \IfBooleanT{#1}{\hat}k%
    \ifthenelse{\equal{#2}{}}{}{_{#2}}%
    ^{\mathsf{Pu}}%
  }}
  \ProvideDocumentCommand{\PriKey}{s m}{\ensuremath{%
    \IfBooleanT{#1}{\hat}k%
    \ifthenelse{\equal{#2}{}}{}{_{#2}}%
    ^{\mathsf{Pr}}%
  }}
  \ProvideDocumentCommand{\MACKey}{s m}{\ensuremath{%
    \IfBooleanT{#1}{\hat}k%
    \ifthenelse{\equal{#2}{}}{}{_{#2}}%
    ^{\mathsf{MA}}%
  }}
  \ProvideDocumentCommand{\TagKey}{s m}{\ensuremath{%
    \IfBooleanT{#1}{\hat}k%
    \ifthenelse{\equal{#2}{}}{}{_{#2}}%
    ^{\mathsf{MA}}%
  }}
  \ProvideDocumentCommand{\SignKey}{s m}{\ensuremath{%
    \IfBooleanT{#1}{\hat}s%
    \ifthenelse{\equal{#2}{}}{}{_{#2}}%
  }}
  \ProvideDocumentCommand{\VerifKey}{s m}{\ensuremath{%
    \IfBooleanT{#1}{\hat}v%
    \ifthenelse{\equal{#2}{}}{}{_{#2}}%
  }}
  % Crypto properties
  \newacro{IND-CPA}{Indistinguishability under Chosen-Plaintext Attack}
  \newacro{IND-CCA}{Indistinguishability under Chosen-Ciphertext Attack}
  \newacro{IND-SFCCA}{Indistinguishability under Stateful Chosen-Ciphertext 
    Attack}
  \newacro{WUF-CMA}{Weak Unforgeability under Chosen-Message Attack}
  \newacro{SUF-CMA}{Strong Unforgeability under Chosen-Message Attack}
  \newacro{INT-PTXT}{Integrity of Plaintexts}
  \newacro{INT-SFPTXT}{Integrity of Stateful Plaintexts}
  \newacro{INT-CTXT}{Integrity of Ciphertexts}
  \newacro{INT-SFCTXT}{Integrity of Stateful Ciphertexts}
  \newacro{DEN-SS}{Deniability under Surveillance-State Attack}
  % Computational problems
  \newacro{DLP}{Discrete Logarithm Problem}
  \newacro{DH}{Diffie-Hellman}
  \newacro{DDH}{Decision Diffie-Hellman}
  \newacro{DCP}{Dining Cryptographers Problem}
  \newacro{SMP}{Socialist Millionaires' Problem}
  % Cryptographic mechanisms
  \newacro{OTP}{One-Time Pad}
  \newacro{ZKP}{Zero-Knowledge Proof of Knowledge}
  \newacro{MAC}{Message-Authentication Code}
  \newacro{PRF}{Pseudo-Random Function}
  \newacro{PRNG}{Pseudo-Random Number Generator}
  \newacro{RNG}{Random Number Generator}
  \newacro{KEM}{Key-Encapsulation Mechanism}
  \newacro{DEM}{Data-Encryption Mechanism}
  \newacro{EtM}{encrypt-then-MAC}
  % Key-exchange mechanisms
  \newacro{DHKE}{Diffie-Hellman Key-Exchange}
  \newacro{AKE}{Authenticated Key-Exchange}
  % Cryptographic properties
  \newacro{PFS}{Perfect Forward-Secrecy}
  % Types of encryption
  \newacro{PKE}{Public-Key Encryption}
  \newacro{BE}{Broadcast Encryption}
  \newacro{ANOBE}{Anonymous Broadcast Encryption}
  \newacro{IBE}{Identity-Based Encryption}
  \newacro{ABE}{Attribute-Based Encryption}
  \newacro{PE}{Predicate Encryption}
  % Protocols
  \newacro{OTR}{Off-the-Record}
}
\DeclareOption{ac}{%
  \newacro{AC}{Access Control}
  % Access Control Models
  \newacro{ABAC}{Attribute-Based Access Control}
  \newacro{RBAC}{Role-Based Access Control}
  \newacro{DAC}{Discretionary Access Control}
  \newacro{acMAC}[MAC]{Mandatory Access Control}
  % Access control objects
  \newacro{ACL}{Access Control List}
}
\DeclareOption{surveillance}{%
  % Surveillance agencies
  \newacro{NSA}{US National Security Agency}
  \newacro{GCHQ}{UK Government Communications Headquarters}
  \newacro{CIA}{US Central Intelligence Agency}
  \newacro{TAO}{Tailored Access Operations}
  \newacro{FRA}{Swedish National Defence Radio Establishment}
}
\DeclareOption{std}{%
  \ProvideDocumentCommand{\concat}{}{\mathbin{\|}}
  \newacro{PET}{Privacy-Enhancing Technology}
  % Types of providers
  \newacro{CSP}{Cloud Service Provider}
  \newacro{ISP}{Internet Service Provider}
  % Entities
  \newacro{TTP}{Trusted Third-Party}
  % Protocols
  \newacro{NFC}{Near-Field Communication}
  % World Wide Web
  \newacro{WWW}{World Wide Web}
  \newacro{URL}{Uniform Resource Locator}
  \newacro{URI}{Uniform Resource Identifier}
  \newacro{URN}{Uniform Resource Name}
  % Social Networks
  \newacro{OSN}{Online Social Network}
  \newacro{DOSN}{Distributed Online Social Network}
  \newacro{IM}{Instant Messaging}
  \newacro{TOC}{Table of Contents}
  % Services/protocols
  \newacro{GPG}{GNU Privacy Guard}
  \newacro{PGP}{Pretty Good Privacy}
  % Models
  \newacro{P2P}{Peer-to-Peer}
}
\ProcessOptions\relax
\endinput
